## ä»»åŠ¡åˆ†è§£è®¡åˆ’

### çº¦æŸ
- **ä¸šåŠ¡ç›®æ ‡**: å‰ç«¯é€‚é…åç«¯å·²å®ç°çš„ Automix åŠŸèƒ½ï¼ˆèŠ‚æ‹æ£€æµ‹ã€BPMåŒæ­¥ã€äº¤å‰æ·¡åŒ–ï¼‰
- **æŠ€æœ¯çº¦æŸ**: Vue 3 + Tauri + Vite æŠ€æœ¯æ ˆï¼Œä¿æŒç°æœ‰ PlayerStore æ¶æ„
- **ä¸å¯å˜éƒ¨åˆ†**: åç«¯ Rust API å·²å›ºå®šï¼Œå‰ç«¯éœ€é€‚é…è°ƒç”¨

### æ‰§è¡Œè·¯çº¿å›¾

1. **åˆ›å»º Tauri å‘½ä»¤å°è£…å±‚** -> éªŒè¯: æ‰€æœ‰å‘½ä»¤å¯æ­£å¸¸è°ƒç”¨ -> å¤±è´¥å›æ»š: åˆ é™¤æ–‡ä»¶
2. **æ‰©å±• PlayerStore çŠ¶æ€ç®¡ç†** -> éªŒè¯: Store çŠ¶æ€æ›´æ–°æ­£å¸¸ -> å¤±è´¥å›æ»š: æ¢å¤ player.js
3. **åˆ›å»º Automix æ§åˆ¶ç»„ä»¶** -> éªŒè¯: UI æ¸²æŸ“æ­£å¸¸ -> å¤±è´¥å›æ»š: åˆ é™¤ç»„ä»¶
4. **é›†æˆ BPM åˆ†æè¿›åº¦ç›‘å¬** -> éªŒè¯: äº‹ä»¶ç›‘å¬æ­£å¸¸ -> å¤±è´¥å›æ»š: ç§»é™¤ç›‘å¬ä»£ç 
5. **æ›´æ–°æ’­æ”¾æ§åˆ¶é€»è¾‘** -> éªŒè¯: æ’­æ”¾/åˆ‡æ¢æ­£å¸¸ -> å¤±è´¥å›æ»š: æ¢å¤æ’­æ”¾é€»è¾‘
6. **æ·»åŠ è®¾ç½®é¡µé¢é€‰é¡¹** -> éªŒè¯: è®¾ç½®ä¿å­˜æ­£å¸¸ -> å¤±è´¥å›æ»š: æ¢å¤è®¾ç½®é¡µ

### é£é™©è¯„ä¼°
- ğŸ”´ é«˜é£é™©: PlayerStore é‡æ„ - å½±å“æ•´ä¸ªæ’­æ”¾å™¨åŠŸèƒ½ï¼Œéœ€å®Œæ•´æµ‹è¯•
- ğŸŸ¡ ä¸­é£é™©: Tauri å‘½ä»¤è°ƒç”¨ - éœ€å¤„ç† Rust é”™è¯¯å’Œç±»å‹è½¬æ¢

### è¯¦ç»†æ­¥éª¤

#### Step 1: Tauri å‘½ä»¤å°è£… (src/api/automix.js)
å°è£…åç«¯å‘½ä»¤:
- `analyze_audio_beat` - åˆ†æå•é¦– BPM
- `batch_analyze_audio` - æ‰¹é‡åˆ†æ
- `get_mix_points` - è·å–æ··éŸ³ç‚¹
- `set_crossfade_enabled` - å¯ç”¨äº¤å‰æ·¡åŒ–
- `set_crossfade_config` - è®¾ç½®æ·¡åŒ–é…ç½®
- `set_bpm_sync_enabled` - å¯ç”¨ BPM åŒæ­¥
- `get_playback_speed_ratio` - è·å–é€Ÿåº¦æ¯”ç‡
- `set_playback_speed` - è®¾ç½®æ’­æ”¾é€Ÿåº¦
- `get_analysis_cache_stats` - è·å–ç¼“å­˜ç»Ÿè®¡

#### Step 2: æ‰©å±• PlayerStore (src/stores/player.js)
æ–°å¢çŠ¶æ€:
- `automixEnabled` - Automix å¼€å…³
- `crossfadeEnabled` - äº¤å‰æ·¡åŒ–å¼€å…³
- `crossfadeDuration` - æ·¡åŒ–æ—¶é•¿
- `bpmSyncEnabled` - BPM åŒæ­¥å¼€å…³
- `playbackSpeed` - æ’­æ”¾é€Ÿåº¦
- `currentBpm` - å½“å‰æ­Œæ›² BPM
- `nextTrackBpm` - ä¸‹ä¸€é¦– BPM
- `isAnalyzing` - åˆ†æä¸­çŠ¶æ€
- `analysisProgress` - åˆ†æè¿›åº¦

æ–°å¢ Actions:
- `enableAutomix()` - å¯ç”¨ Automix
- `disableAutomix()` - ç¦ç”¨ Automix
- `analyzeCurrentTrack()` - åˆ†æå½“å‰æ­Œæ›²
- `preloadNextTrack()` - é¢„åŠ è½½ä¸‹ä¸€é¦–
- `setCrossfade(enabled, duration)` - è®¾ç½®äº¤å‰æ·¡åŒ–
- `setBpmSync(enabled)` - è®¾ç½® BPM åŒæ­¥
- `setPlaybackSpeed(speed)` - è®¾ç½®æ’­æ”¾é€Ÿåº¦

#### Step 3: Automix æ§åˆ¶ç»„ä»¶ (src/components/player/AutomixControls.vue)
UI å…ƒç´ :
- Automix å¼€å…³æŒ‰é’®
- äº¤å‰æ·¡åŒ–æ—¶é•¿æ»‘å—
- BPM åŒæ­¥å¼€å…³
- æ’­æ”¾é€Ÿåº¦æ˜¾ç¤º
- å½“å‰æ­Œæ›² BPM æ˜¾ç¤º

#### Step 4: BPM åˆ†æè¿›åº¦ç›‘å¬
åœ¨ PlayerStore ä¸­ç›‘å¬:
- `analysis_progress` äº‹ä»¶
- æ›´æ–° `analysisProgress` çŠ¶æ€
- æ˜¾ç¤ºåˆ†æè¿›åº¦æ¡

#### Step 5: æ›´æ–°æ’­æ”¾æ§åˆ¶é€»è¾‘
ä¿®æ”¹ `playNext()` å’Œ `handleTrackEnded()`:
- å¯ç”¨ Automix æ—¶é¢„åŠ è½½ä¸‹ä¸€é¦–
- è°ƒç”¨ `preload_next_audio`
- è®¾ç½® BPM ä¿¡æ¯
- å¯ç”¨äº¤å‰æ·¡åŒ–æ—¶è‡ªåŠ¨åˆ‡æ¢

#### Step 6: è®¾ç½®é¡µé¢é€‰é¡¹ (src/views/SettingsView.vue)
æ·»åŠ è®¾ç½®é¡¹:
- Automix é»˜è®¤å¼€å…³
- äº¤å‰æ·¡åŒ–é»˜è®¤æ—¶é•¿
- äº¤å‰æ·¡åŒ–æ›²çº¿ç±»å‹
- BPM åŒæ­¥é»˜è®¤å¼€å…³

### éªŒè¯æ ‡å‡†
- [ ] æ‰€æœ‰ Tauri å‘½ä»¤å¯æ­£å¸¸è°ƒç”¨
- [ ] PlayerStore çŠ¶æ€æ›´æ–°æ­£ç¡®
- [ ] Automix å¼€å…³æ§åˆ¶æ­£å¸¸
- [ ] BPM åˆ†æè¿›åº¦æ˜¾ç¤ºæ­£å¸¸
- [ ] äº¤å‰æ·¡åŒ–æ•ˆæœæ­£å¸¸
- [ ] æ’­æ”¾åˆ‡æ¢æ— å¡é¡¿

è¯·ç¡®è®¤æ­¤è®¡åˆ’åæˆ‘å°†å¼€å§‹æ‰§è¡Œ Step 1ã€‚